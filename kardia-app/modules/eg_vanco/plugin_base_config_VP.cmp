$Version=2$
plugin_base_config_ss "widget/component-decl"
    {
    width=828;
    height=490;
    title = "Vanco Payments";
    description = "Configure electronic giving integration with Vanco's online giving service, so that donations can be easily imported into the Kardia receipting and finance system";
    sequence = 1002;

    vbox "widget/vbox"
	{
	x=0; y=0;
	width=828; height=490;
	spacing=7;

	ledger_lbl "widget/label" { height=16; style=bold; text="Accounting Ledger Selection:"; }

	ledger_osrc "widget/osrc"
	    {
	    sql = "select :name, label=:a_ledger_number + ' - ' + :a_ledger_desc, :a_ledger_number from /apps/kardia/data/Kardia_DB/a_ledger/rows";

	    ledger_dd "widget/dropdown"
		{
		height=24; width=300;
		mode=objectsource;
		fieldname=label;
		numdisplay=12;
		}
	    }

	sep1 "widget/autolayoutspacer" { height=1; }

	config_lbl "widget/label" { height=16; style=bold; text="Vanco Integration Configuration:"; }

	config_osrc "widget/osrc"
	    {
	    a_ledger_number "widget/parameter" { type=string; }
	    sql = "select * from object expression('/apps/kardia/modules/gl/accounting_config.qyp/' + :parameters:a_ledger_number)";

	    config_link "widget/rule"
		{
		ruletype=osrc_relationship;
		target=ledger_osrc;
		key_1=a_ledger_number;
		target_key_1=a_ledger_number;
		}

	    config_form "widget/form"
		{
		allow_query=no;
		vp_label_0 "widget/label" { height=10; text="Select this checkbox to allow Kardia to import data from Vanco Payments using Kardia's Gift Import tool."; }
		enab_hbox "widget/hbox"
		    {
		    height=24; spacing=10;
		    vp_enab "widget/component" { path="/sys/cmp/smart_field.cmp"; height=25; field="GiftImport_VP"; width=120; text="Enabled:"; ctl_type=checkbox; enab_hints "widget/hints" { style=notnull; } }
		    vp_enab_pmx "widget/component" { path="/sys/cmp/smart_field.cmp"; height=25; field="GiftImport_VPMX"; text="Enable PMX:"; ctl_type=checkbox; enab_vp_hints "widget/hints" { style=notnull; } }
		    }
		vp_label_1 "widget/label" { height=15; text="The Hostname, API ID, API Secret, and API Client are values that need to be obtained from Vanco."; }
		vp_host "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_Site"; text="Hostname:"; width=500; ctl_type=editbox; }
		vp_id "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_Username"; text="API ID:"; width=300; ctl_type=editbox; }
		vp_secret "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_Secret"; text="API Secret:"; width=500; ctl_type=editbox; }
		vp_client "widget/component" { path="/sys/cmp/smart_field.cmp"; height=20; field="VP_Client"; text="API Client ID:"; width=500; ctl_type=editbox; }
		vp_pmx_host "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_PMX_Site"; text="PMX Hostname:"; width=500; ctl_type=editbox; }
		vp_pmx_id "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_PMX_Username"; text="PMX API ID:"; width=300; ctl_type=editbox; }
		vp_pmx_secret "widget/component" { path="/sys/cmp/smart_field.cmp"; height=15; field="VP_PMX_Secret"; text="PMX API Secret:"; width=500; ctl_type=editbox; }
		vp_pmx_client "widget/component" { path="/sys/cmp/smart_field.cmp"; height=25; field="VP_PMX_Client"; text="PMX API Client ID:"; width=500; ctl_type=editbox; }

		vp_label_2 "widget/label" { height=35; text="The Lookback controls how many days back Kardia looks at when it connects to Vanco to examine the online giving data for new and changed gift information.  Set this to at least a day longer than the number of days between gift imports. Be careful not to set the lookback to too long; the process will be slowed."; }
		lb_settle_hbox "widget/hbox" { height=25; spacing=10; ss_lookback "widget/component" { path="/sys/cmp/smart_field.cmp"; height=24; field="VP_Lookback"; text="Lookback:"; width=200; ctl_type=editbox; } }
		
		vp_label_3 "widget/label" { height=10; text="Enable this to use deposit date rather than settlment date to determine when to mark transactions as pending instead of paid"; }
		vp_use_deposit "widget/component" { path="/sys/cmp/smart_field.cmp"; height=25; field="VP_UseDepo"; text="Use Deposit Date:"; ctl_type=checkbox; vp_enab_hints "widget/hints" { style=notnull; } }
		
		}
	    }

	ctls_hbox "widget/hbox"
	    {
	    height=24;
	    align=center;
	    spacing=10;

	    save_btn "widget/textbutton"
		{
		height=24; width=130;
		text = "Save";
		enabled=runclient(:config_form:is_savable);

		on_save "widget/connector" { event=Click; target=config_form; action=Save; }
		}

	    cancel_btn "widget/textbutton"
		{
		height=24; width=130;
		text = "Cancel";
		enabled=runclient(:config_form:is_discardable);

		on_cancel "widget/connector" { event=Click; target=config_form; action=Discard; }
		}
	    }
	}
    }

